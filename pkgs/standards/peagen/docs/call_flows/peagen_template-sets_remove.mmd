sequenceDiagram
    participant User
    participant CLI as peagen template-sets remove
    participant Env as PythonEnv
    participant Pip as PipInstaller
    User ->> CLI: Run `peagen template-sets remove <SET_NAME> [-y]`
    CLI ->> Env: Scan installed distributions for entry_point matching SET_NAME in "peagen.template_sets"
    Env -->> CLI: Return list of distribution names providing that template-set
    alt if list is empty
        CLI -->> User: Print "❌ Template-set 'name' not found" (nothing to remove)
        CLI -->> User: Exit
    end
    CLI ->> CLI: Separate protected core distributions (e.g. peagen)
    alt if only protected dists found
        CLI -->> User: Print warning (cannot uninstall core template-set)
        CLI -->> User: Exit
    else
        alt if both core and others found
            CLI -->> User: Warn skipping core package, proceeding with others
        end
        opt if -y not given
            CLI ->> User: Prompt confirmation "Uninstall distributions: X, Y?"
            User -->> CLI: Confirm (yes or no)
            alt if user cancels
                CLI -->> User: "Aborted." (exit without changes)
            end
        end
        CLI ->> Pip: Run pip uninstall for the target distribution(s) (non-interactive)
        Pip -->> CLI: Success or error
        alt if uninstall failed
            CLI -->> User: Print "❌ Uninstall failed." and output error
            CLI -->> User: Exit with error
        else
            CLI ->> Env: Discover template-sets again to verify removal
            Env -->> CLI: Return whether SET_NAME is still present
            alt if still present
                CLI -->> User: Print "⚠️  ... still discoverable." (warning)
            else
                CLI -->> User: Print "✅ Removed template-set 'name'."
            end
        end
    end

sequenceDiagram
    participant User
    participant CLI as peagen program diff
    participant Net as Manifest Source
    participant FS as File System
    User ->> CLI: Run `peagen program diff <left> <right> [--md file]`
    CLI ->> CLI: For each of left/right:
    alt if input is directory
        CLI ->> FS: Use it as a workspace
    else
        CLI ->> Net: Download manifest & files (ensure workspace)
        Net -->> CLI: Returns temp workspace directory
    end
    CLI ->> FS: Scan left workspace for all file paths
    CLI ->> FS: Scan right workspace for all file paths
    CLI ->> CLI: Determine added files (in right only), removed files (in left only)
    CLI ->> CLI: For common files, compute hashes to find modified ones
    CLI ->> CLI: Build diff table in Markdown format
    alt if --md option provided
        CLI ->> FS: Write diff table to output Markdown file
    else
        CLI -->> User: Print diff table to console
    end

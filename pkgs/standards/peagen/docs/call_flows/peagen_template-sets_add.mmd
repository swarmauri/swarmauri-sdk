sequenceDiagram
    participant User
    participant CLI as peagen template-sets add
    participant Pip as PipInstaller
    participant Env as PythonEnv
    User ->> CLI: Run `peagen template-sets add <SOURCE> [--from-bundle X] [--editable] [--force]`
    CLI ->> CLI: Determine source type:
    opt if local directory
        CLI -->> CLI: prepare pip install (maybe -e)
    end
    opt if local wheel/tar
        CLI -->> CLI: prepare pip install file path
    end
    opt if PyPI slug
        CLI -->> CLI: prepare pip install <slug>
    end
    CLI ->> Pip: Invoke pip install (via subprocess)
    Pip -->> CLI: Success or error (exception if fails)
    alt if installation failed
        CLI -->> User: Print "❌ Installation failed." and error output
        CLI -->> User: Exit with error code
    else
        CLI ->> Env: Discover template-sets before vs after install
        Env -->> CLI: Return set of newly added template-set names
        alt if new_sets not empty
            CLI -->> User: Print "✅ Installed template-set(s): X, Y..."
        else
            CLI -->> User: Print warning (no new set detected, possibly already installed)
        end
    end

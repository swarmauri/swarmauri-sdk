sequenceDiagram
    participant User
    participant CLI as peagen program patch
    participant FS as File System
    participant JSON as JsonPatch
    User ->> CLI: Run `peagen program patch <workspace> [--overlay dir] [--patch file]`
    CLI ->> FS: Resolve target workspace path
    alt if --overlay is provided
        CLI ->> FS: Read overlayâ€™s `.peagen-delete` list (if exists) and remove those files from base
        CLI ->> FS: Copy all files from overlay directory into base workspace (overwrite existing)
        CLI -->> User: "overlay applied" confirmation
    end
    alt if --patch file is provided
        CLI ->> FS: Read entire workspace into a JSON object (file tree)
        CLI ->> JSON: Load patch operations from file and apply them to JSON object
        CLI ->> FS: Write modified JSON content back to workspace files
        CLI -->> User: "json-patch applied" confirmation
    end
